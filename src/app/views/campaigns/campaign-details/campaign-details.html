<main class="p-6">
  <!-- Campaign Details -->
  <div *ngIf="campaign">
    <!-- Header -->
    <div class="flex items-center justify-between mb-6">
      <div class="flex items-center gap-4">
        <button
          type="button"
          (click)="goBack()"
          class="btn btn-sm bg-default-100 text-default-600 hover:bg-default-200">
          <div class="size-4 me-1"><ng-icon name="lucideArrowLeft"></ng-icon></div>
          {{ 'CAMPAIGNS.DETAILS.BACK' | translate }}
        </button>
        <div>
          <h1 class="text-2xl font-semibold text-default-900">{{ campaign.name }}</h1>
          <p class="text-sm text-default-600 mt-1">
            {{ 'CAMPAIGNS.DETAILS.CREATED' | translate }} {{ formatDate(campaign.createdAt) }}
          </p>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex items-center gap-2">
        <button
          *ngIf="campaign.status === 'sent'"
          type="button"
          (click)="viewStats()"
          class="btn btn-sm bg-info/10 text-info hover:bg-info/20">
          <div class="size-4 me-1"><ng-icon name="lucideActivity"></ng-icon></div>
          {{ 'CAMPAIGNS.STATISTICS' | translate }}
        </button>
        <button
          *ngIf="campaign.status === 'draft' || campaign.status === 'scheduled'"
          type="button"
          (click)="editCampaign()"
          class="btn btn-sm bg-primary/10 text-primary hover:bg-primary/20">
          <div class="size-4 me-1"><ng-icon name="lucidePencil"></ng-icon></div>
          {{ 'COMMON.EDIT' | translate }}
        </button>
        <button
          type="button"
          (click)="duplicateCampaign()"
          class="btn btn-sm bg-default-100 text-default-600 hover:bg-default-200">
          <div class="size-4 me-1"><ng-icon name="lucideCopy"></ng-icon></div>
          {{ 'COMMON.DUPLICATE' | translate }}
        </button>
        <button
          *ngIf="campaign.status === 'draft'"
          type="button"
          (click)="sendCampaign()"
          class="btn btn-sm bg-success text-white hover:bg-success/90">
          <div class="size-4 me-1"><ng-icon name="lucideSend"></ng-icon></div>
          {{ 'COMMON.SEND' | translate }}
        </button>
        <button
          type="button"
          (click)="deleteCampaign()"
          class="btn btn-sm bg-danger/10 text-danger hover:bg-danger/20">
          <div class="size-4 me-1"><ng-icon name="lucideTrash2"></ng-icon></div>
          {{ 'COMMON.DELETE' | translate }}
        </button>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Main Content -->
      <div class="lg:col-span-2 space-y-6">
        <!-- Status and Basic Info -->
        <div class="card p-6">
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-lg font-semibold text-default-900">{{ 'CAMPAIGNS.DETAILS.BASIC_INFO' | translate }}</h2>
            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium" [ngClass]="getStatusClass(campaign.status)">
              {{ getStatusLabel(campaign.status) }}
            </span>
          </div>

          <div class="space-y-4">
            <div class="flex items-start gap-3">
              <div class="size-10 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                <div class="size-5 text-primary"><ng-icon name="lucideMail"></ng-icon></div>
              </div>
              <div class="flex-1">
                <div class="text-xs text-default-600 mb-1">{{ 'CAMPAIGNS.DETAILS.SUBJECT_LINE' | translate }}</div>
                <div class="text-sm font-medium text-default-900">{{ campaign.subject }}</div>
              </div>
            </div>

            <div *ngIf="campaign.preheader" class="flex items-start gap-3">
              <div class="size-10 bg-default-100 rounded-lg flex items-center justify-center flex-shrink-0">
                <div class="size-5 text-default-600"><ng-icon name="lucideEye"></ng-icon></div>
              </div>
              <div class="flex-1">
                <div class="text-xs text-default-600 mb-1">{{ 'CAMPAIGNS.DETAILS.PREHEADER_TEXT' | translate }}</div>
                <div class="text-sm font-medium text-default-900">{{ campaign.preheader }}</div>
              </div>
            </div>

            <div class="flex items-start gap-3">
              <div class="size-10 bg-success/10 rounded-lg flex items-center justify-center flex-shrink-0">
                <div class="size-5 text-success"><ng-icon name="lucideUser"></ng-icon></div>
              </div>
              <div class="flex-1">
                <div class="text-xs text-default-600 mb-1">{{ 'CAMPAIGNS.DETAILS.FROM' | translate }}</div>
                <div class="text-sm font-medium text-default-900">{{ campaign.fromName }} &lt;{{ campaign.fromEmail }}&gt;</div>
              </div>
            </div>

            <div *ngIf="campaign.replyTo" class="flex items-start gap-3">
              <div class="size-10 bg-info/10 rounded-lg flex items-center justify-center flex-shrink-0">
                <div class="size-5 text-info"><ng-icon name="lucideMail"></ng-icon></div>
              </div>
              <div class="flex-1">
                <div class="text-xs text-default-600 mb-1">{{ 'CAMPAIGNS.DETAILS.REPLY_TO' | translate }}</div>
                <div class="text-sm font-medium text-default-900">{{ campaign.replyTo }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Content Preview -->
        <div class="card p-6">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-lg font-semibold text-default-900">{{ 'CAMPAIGNS.DETAILS.CONTENT_PREVIEW' | translate }}</h2>
            <button
              type="button"
              (click)="togglePreview()"
              class="btn btn-sm bg-primary/10 text-primary hover:bg-primary/20">
              <div class="size-4 me-1"><ng-icon name="lucideEye"></ng-icon></div>
              {{ showHtmlPreview ? ('COMMON.CLOSE' | translate) : ('COMMON.VIEW' | translate) }} HTML
            </button>
          </div>

          <div *ngIf="!showHtmlPreview" class="space-y-4">
            <div *ngIf="campaign.content.html">
              <div class="text-xs font-medium text-default-600 mb-2">{{ 'CAMPAIGNS.DETAILS.HTML_CONTENT' | translate }}</div>
              <div class="bg-default-50 border border-default-200 rounded-lg p-4 max-h-64 overflow-auto">
                <pre class="text-xs text-default-900 whitespace-pre-wrap font-mono">{{ campaign.content.html }}</pre>
              </div>
            </div>

            <div *ngIf="campaign.content.text">
              <div class="text-xs font-medium text-default-600 mb-2">{{ 'CAMPAIGNS.DETAILS.TEXT_VERSION' | translate }}</div>
              <div class="bg-default-50 border border-default-200 rounded-lg p-4 max-h-64 overflow-auto">
                <pre class="text-xs text-default-900 whitespace-pre-wrap">{{ campaign.content.text }}</pre>
              </div>
            </div>

            <div *ngIf="!campaign.content.html && !campaign.content.text" class="text-center py-8 text-default-600">
              {{ 'CAMPAIGNS.DETAILS.NO_CONTENT' | translate }}
            </div>
          </div>

          <div *ngIf="showHtmlPreview && campaign.content.html" class="border border-default-200 rounded-lg p-4 bg-white max-h-96 overflow-auto">
            <iframe
              [srcdoc]="campaign.content.html"
              class="w-full min-h-[400px] border-0"
              sandbox="allow-same-origin">
            </iframe>
          </div>
        </div>

        <!-- Statistics (if sent) -->
        <div *ngIf="campaign.status === 'sent'" class="card p-6">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-lg font-semibold text-default-900">{{ 'CAMPAIGNS.STATISTICS' | translate }}</h2>
            <button
              type="button"
              (click)="viewStats()"
              class="text-sm text-primary hover:text-primary/80">
              {{ 'CAMPAIGNS.DETAILS.VIEW_DETAILS' | translate }} â†’
            </button>
          </div>

          <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="text-center p-4 bg-default-50 rounded-lg">
              <div class="text-2xl font-semibold text-default-900">{{ formatNumber(campaign.statistics.sent) }}</div>
              <div class="text-xs text-default-600 mt-1">{{ 'CAMPAIGNS.SENT' | translate }}</div>
            </div>
            <div class="text-center p-4 bg-success/5 rounded-lg">
              <div class="text-2xl font-semibold text-success">{{ campaign.statistics.performance.openRate.toFixed(1) }}%</div>
              <div class="text-xs text-default-600 mt-1">{{ 'CAMPAIGNS.OPENS' | translate }}</div>
            </div>
            <div class="text-center p-4 bg-primary/5 rounded-lg">
              <div class="text-2xl font-semibold text-primary">{{ campaign.statistics.performance.clickRate.toFixed(1) }}%</div>
              <div class="text-xs text-default-600 mt-1">{{ 'CAMPAIGNS.CLICKS' | translate }}</div>
            </div>
            <div class="text-center p-4 bg-danger/5 rounded-lg">
              <div class="text-2xl font-semibold text-danger">{{ formatNumber(campaign.statistics.unsubscribes) }}</div>
              <div class="text-xs text-default-600 mt-1">{{ 'CAMPAIGNS.UNSUBSCRIBES' | translate }}</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Sidebar -->
      <div class="space-y-6">
        <!-- Recipients Info -->
        <div class="card p-6">
          <h3 class="text-sm font-semibold text-default-900 mb-4">{{ 'CAMPAIGNS.RECIPIENTS' | translate }}</h3>
          <div class="space-y-3">
            <div class="flex items-center justify-between">
              <span class="text-sm text-default-600">{{ 'CAMPAIGNS.TOTAL' | translate }}:</span>
              <span class="text-lg font-semibold text-primary">{{ formatNumber(campaign.recipients.totalCount || 0) }}</span>
            </div>
            <div class="pt-3 border-t border-default-200">
              <div class="text-xs text-default-600 mb-2">{{ 'CAMPAIGNS.RECIPIENTS' | translate }}:</div>
              <div class="text-sm font-medium text-default-900 capitalize">
                <span *ngIf="campaign.recipients.type === 'all'">{{ 'CAMPAIGNS.DETAILS.ALL_SUBSCRIBERS' | translate }}</span>
                <span *ngIf="campaign.recipients.type === 'lists'">{{ 'CAMPAIGNS.DETAILS.SPECIFIC_LISTS' | translate }}</span>
                <span *ngIf="campaign.recipients.type === 'segments'">{{ 'CAMPAIGNS.DETAILS.SEGMENTS' | translate }}</span>
                <span *ngIf="campaign.recipients.type === 'tags'">{{ 'CAMPAIGNS.DETAILS.TAGS' | translate }}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Schedule Info -->
        <div class="card p-6">
          <h3 class="text-sm font-semibold text-default-900 mb-4">{{ 'CAMPAIGNS.SCHEDULE' | translate }}</h3>
          <div class="space-y-3">
            <div *ngIf="campaign.sentAt" class="flex items-start gap-3">
              <div class="size-8 bg-success/10 rounded-lg flex items-center justify-center flex-shrink-0">
                <div class="size-4 text-success"><ng-icon name="lucideCircleCheck"></ng-icon></div>
              </div>
              <div>
                <div class="text-xs text-default-600">{{ 'CAMPAIGNS.DETAILS.SENT_STATUS' | translate }}</div>
                <div class="text-sm font-medium text-default-900 mt-1">{{ formatDate(campaign.sentAt) }}</div>
              </div>
            </div>

            <div *ngIf="campaign.scheduledFor && !campaign.sentAt" class="flex items-start gap-3">
              <div class="size-8 bg-warning/10 rounded-lg flex items-center justify-center flex-shrink-0">
                <div class="size-4 text-warning"><ng-icon name="lucideClock"></ng-icon></div>
              </div>
              <div>
                <div class="text-xs text-default-600">{{ 'CAMPAIGNS.DETAILS.SCHEDULED_FOR' | translate }}</div>
                <div class="text-sm font-medium text-default-900 mt-1">{{ formatDate(campaign.scheduledFor) }}</div>
              </div>
            </div>

            <div *ngIf="!campaign.sentAt && !campaign.scheduledFor" class="flex items-start gap-3">
              <div class="size-8 bg-default-100 rounded-lg flex items-center justify-center flex-shrink-0">
                <div class="size-4 text-default-600"><ng-icon name="lucideCircleAlert"></ng-icon></div>
              </div>
              <div>
                <div class="text-xs text-default-600">{{ 'COMMON.STATUS' | translate }}</div>
                <div class="text-sm font-medium text-default-900 mt-1">{{ 'CAMPAIGNS.DETAILS.NOT_SCHEDULED' | translate }}</div>
              </div>
            </div>

            <div class="pt-3 border-t border-default-200">
              <div class="flex items-center gap-2 text-xs text-default-600">
                <ng-icon name="lucideCalendar" class="size-3.5"></ng-icon>
                <span>{{ 'CAMPAIGNS.DETAILS.CREATED' | translate }}: {{ formatDate(campaign.createdAt) }}</span>
              </div>
              <div class="flex items-center gap-2 text-xs text-default-600 mt-2">
                <ng-icon name="lucideCalendar" class="size-3.5"></ng-icon>
                <span>{{ 'CAMPAIGNS.DETAILS.UPDATED' | translate }}: {{ formatDate(campaign.updatedAt) }}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Settings -->
        <div class="card p-6">
          <h3 class="text-sm font-semibold text-default-900 mb-4">{{ 'CAMPAIGNS.DETAILS.SETTINGS' | translate }}</h3>
          <div class="space-y-2">
            <div class="flex items-center justify-between text-sm">
              <span class="text-default-600">{{ 'CAMPAIGNS.TRACKING.TRACK_OPENS' | translate }}:</span>
              <span [class.text-success]="campaign.settings.trackOpens" [class.text-default-500]="!campaign.settings.trackOpens">
                {{ campaign.settings.trackOpens ? ('CAMPAIGNS.TRACKING.ENABLED' | translate) : ('CAMPAIGNS.TRACKING.DISABLED' | translate) }}
              </span>
            </div>
            <div class="flex items-center justify-between text-sm">
              <span class="text-default-600">{{ 'CAMPAIGNS.TRACKING.TRACK_CLICKS' | translate }}:</span>
              <span [class.text-success]="campaign.settings.trackClicks" [class.text-default-500]="!campaign.settings.trackClicks">
                {{ campaign.settings.trackClicks ? ('CAMPAIGNS.TRACKING.ENABLED' | translate) : ('CAMPAIGNS.TRACKING.DISABLED' | translate) }}
              </span>
            </div>
            <div class="flex items-center justify-between text-sm">
              <span class="text-default-600">{{ 'CAMPAIGNS.TRACKING.GOOGLE_ANALYTICS' | translate }}:</span>
              <span [class.text-success]="campaign.settings.googleAnalytics?.enabled" [class.text-default-500]="!campaign.settings.googleAnalytics?.enabled">
                {{ campaign.settings.googleAnalytics?.enabled ? ('CAMPAIGNS.TRACKING.ENABLED' | translate) : ('CAMPAIGNS.TRACKING.DISABLED' | translate) }}
              </span>
            </div>
          </div>
        </div>

        <!-- Type Badge -->
        <div class="bg-gradient-to-br from-primary/5 to-primary/10 border border-primary/20 rounded-lg p-6">
          <div class="text-xs text-default-600 mb-1">{{ 'CAMPAIGNS.DETAILS.CAMPAIGN_TYPE_LABEL' | translate }}</div>
          <div class="text-sm font-semibold text-primary capitalize">
            <span *ngIf="campaign.type === 'regular'">{{ 'CAMPAIGNS.DETAILS.TYPE_REGULAR' | translate }}</span>
            <span *ngIf="campaign.type === 'ab_test'">{{ 'CAMPAIGNS.DETAILS.TYPE_AB_TEST' | translate }}</span>
            <span *ngIf="campaign.type === 'rss'">{{ 'CAMPAIGNS.DETAILS.TYPE_RSS' | translate }}</span>
            <span *ngIf="campaign.type === 'automated'">{{ 'CAMPAIGNS.DETAILS.TYPE_AUTOMATED' | translate }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Not Found -->
  <div *ngIf="!campaign" class="text-center py-12">
    <div class="size-16 mx-auto mb-4 text-default-400">
      <ng-icon name="lucideCircleAlert"></ng-icon>
    </div>
    <h3 class="text-lg font-medium text-default-900 mb-2">{{ 'CAMPAIGNS.DETAILS.NOT_FOUND' | translate }}</h3>
    <p class="text-default-600 mb-6">{{ 'CAMPAIGNS.DETAILS.NOT_FOUND_MESSAGE' | translate }}</p>
    <button
      type="button"
      (click)="goBack()"
      class="btn bg-primary text-white">
      <div class="size-4 me-1"><ng-icon name="lucideArrowLeft"></ng-icon></div>
      {{ 'CAMPAIGNS.DETAILS.BACK_TO_LIST' | translate }}
    </button>
  </div>
</main>
